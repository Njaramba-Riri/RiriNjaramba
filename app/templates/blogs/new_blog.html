{% extends 'base.html'  %}
{% import 'macros/_form.html' as macro %}
{% import 'macros/pagination.html' as footer %}

{% block title %}Bytes - New{% endblock %}

{% block content %}
{% include 'include/nav.html' %}
{% include 'include/sidebar.html' %}
<div class="byte-edit">
    <div class="items">
        <div class="blog-form">
            <form action="{{ url_for('.new_blog') }}" method="post" >
                <div class="top">
                    {% for field in form if field.type == 'SubmitField' %}
                        {{ field(class_='submit-blog') }}
                    {% endfor %}
                    <h3>What's on your mind?.</h3>                    
                </div>
                <div class="fields">
                    {{ macro.render(form) }}                    
                </div>
            </form>        
        </div>
        <div class="side">
            <div class="recent">
            {% if current_user.id == user.id %}
                {% for post in posts %}
                    <h2>Your latest bytes.</h2>
                    <div class="rece">
                        <span class="index">#{{ loop.index }}</span>
                        {% if post.title_html %}
                            <a href="{{ url_for('blogs.blog', title=post.title) }}">
                                {{ post.title | safe }}
                            </a>
                        {% else %}
                            <a href="{{ url_for('blogs.blog', title=post.title_html) | safe }}">
                                {{ post.title | safe }}
                            </a>
                        {% endif %}                        
                    </div>
                {% endfor %}               
            {% endif %}               
            <div class="top-tag">
                <h2>Trending</h2>
                <div class="tops">
                    {% for tag in tags %}
                        <p>
                            <span  class="tag" data-url="{{ url_for('.blog_by_tag', tag_name=tag.name) }}" title="Click for more on {{ tag.name }}">
                                #{{ tag.name }}
                            </span>
                        </p>
                    {% endfor %}                    
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block js %}
    {{ super() }}
    {{ pagedown.include_pagedown() }}
    {{ moment.include_moment() }}
    <script>
        ClassicEditor
        .create( document.querySelector('#title'), {
            toolbar: [ 'heading', '|', 'bold', 'italic']
        });
        ClassicEditor
        .create( document.querySelector( '#editor' ))
		.then( editor => {
			window.editor = editor;
		} )
		.catch( err => {
			console.error( err.stack );
		} );
        // CKEDITOR.replace('#editor');
    </script>
{% endblock %}
